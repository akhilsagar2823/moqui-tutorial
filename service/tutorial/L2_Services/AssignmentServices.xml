<?xml version="1.0" encoding="UTF-8"?>
<services xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/service-definition-2.1.xsd">
    <service verb="create" noun="OrderHeader">
        <in-parameters>
            <parameter name="orderName" required="true"/>
            <parameter name="currencyUomId" default-value="USD"/>
            <parameter name="salesChannelEnumId" />
            <parameter name="statusId" default-value="OrderPlaced"/>
            <parameter name="productStoreId"/>
            <parameter name="placedDate" type="Timestamp" required="true"/>
            <parameter name="approvedDate" type="Timestamp"/>
        </in-parameters>
        <out-parameters>
            <parameter name="orderId"/>
        </out-parameters>
        <actions>
            <service-call name="mantle.order.OrderServices.create#Order" in-map="context" out-map="context"/>
        </actions>
    </service>

<!--//////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->

    <service verb="create" noun="AddOrder">
        <in-parameters>
            <parameter name="orderId" required="true"/>
            <parameter name="partName"/>
            <parameter name="facilityId" required="true"/>
            <parameter name="shipmentMethodEnumId" default-value="ShMthGround"/>
            <parameter name="customerPartyId" required="true" default-value="CustJqp"/>
            <parameter name="itemDetails" type="List" required="true">
                <parameter name="itemMap" type="Map">
                    <parameter name="productId" required="true"/>
                    <parameter name="itemDescription"/>
                    <parameter name="quantity" required="true"/>
                    <parameter name="unitAmount" required="true"/>
                </parameter>
            </parameter>
        </in-parameters>
        <out-parameters>
            <parameter name="orderId"/>
            <parameter name="orderPartSeqId"/>
        </out-parameters>
        <actions>
            <service-call name="create#mantle.order.OrderPart" in-map="context" out-map="context"/>
            <iterate list="itemDetails" entry="itemMap">
<!--                <log message="///////////////${[orderId:orderId,orderPartSeqId:orderPartSeqId]+itemMap}/////////////"/>-->
                <service-call name="create#mantle.order.OrderItem" in-map="[orderId:orderId,orderPartSeqId:orderPartSeqId]+
                        itemMap" out-map="context"/>
            </iterate>
        </actions>
    </service>
</services>